<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SVI Interactive</title>
  <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
  <style>
    body {
      margin: 0;
      font-family: "Fira Sans", Arial, sans-serif;
      background: #0f141b;
      color: #e6e6e6;
    }
    .container {
      max-width: 980px;
      margin: 24px auto;
      padding: 0 16px;
    }
    .controls {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px 24px;
      margin-bottom: 16px;
    }
    .control label {
      display: block;
      font-size: 14px;
      margin-bottom: 4px;
    }
    input[type="range"] {
      width: 100%;
    }
    #plot {
      background: #0f141b;
      border: 1px solid #2b3340;
      border-radius: 8px;
    }
    @media (max-width: 720px) {
      .controls {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>SVI total variance</h2>
    <div class="controls">
      <div class="control">
        <label>a: <span id="a_val">0.20</span></label>
        <input id="a" type="range" min="-1.0" max="1.0" step="0.01" value="0.20" />
      </div>
      <div class="control">
        <label>b: <span id="b_val">0.50</span></label>
        <input id="b" type="range" min="0.0" max="3.0" step="0.01" value="0.50" />
      </div>
      <div class="control">
        <label>rho: <span id="rho_val">0.00</span></label>
        <input id="rho" type="range" min="-0.99" max="0.99" step="0.01" value="0.00" />
      </div>
      <div class="control">
        <label>m: <span id="m_val">0.00</span></label>
        <input id="m" type="range" min="-1.0" max="1.0" step="0.01" value="0.00" />
      </div>
      <div class="control">
        <label>sigma: <span id="sigma_val">0.20</span></label>
        <input id="sigma" type="range" min="0.01" max="2.0" step="0.01" value="0.20" />
      </div>
    </div>
    <div id="plot"></div>
  </div>

  <script>
    const k = [-1.000000,-0.994987,-0.989975,-0.984962,-0.979950,-0.974937,-0.969925,-0.964912,-0.959900,-0.954887,-0.949875,-0.944862,-0.939850,-0.934837,-0.929825,-0.924812,-0.919799,-0.914787,-0.909774,-0.904762,-0.899749,-0.894737,-0.889724,-0.884712,-0.879699,-0.874687,-0.869674,-0.864662,-0.859649,-0.854637,-0.849624,-0.844612,-0.839599,-0.834586,-0.829574,-0.824561,-0.819549,-0.814536,-0.809524,-0.804511,-0.799499,-0.794486,-0.789474,-0.784461,-0.779449,-0.774436,-0.769424,-0.764411,-0.759398,-0.754386,-0.749373,-0.744361,-0.739348,-0.734336,-0.729323,-0.724311,-0.719298,-0.714286,-0.709273,-0.704261,-0.699248,-0.694236,-0.689223,-0.684211,-0.679198,-0.674185,-0.669173,-0.664160,-0.659148,-0.654135,-0.649123,-0.644110,-0.639098,-0.634085,-0.629073,-0.624060,-0.619048,-0.614035,-0.609023,-0.604010,-0.598997,-0.593985,-0.588972,-0.583960,-0.578947,-0.573935,-0.568922,-0.563910,-0.558897,-0.553885,-0.548872,-0.543860,-0.538847,-0.533835,-0.528822,-0.523810,-0.518797,-0.513784,-0.508772,-0.503759,-0.498747,-0.493734,-0.488722,-0.483709,-0.478697,-0.473684,-0.468672,-0.463659,-0.458647,-0.453634,-0.448622,-0.443609,-0.438596,-0.433584,-0.428571,-0.423559,-0.418546,-0.413534,-0.408521,-0.403509,-0.398496,-0.393484,-0.388471,-0.383459,-0.378446,-0.373434,-0.368421,-0.363409,-0.358396,-0.353383,-0.348371,-0.343358,-0.338346,-0.333333,-0.328321,-0.323308,-0.318296,-0.313283,-0.308271,-0.303258,-0.298246,-0.293233,-0.288221,-0.283208,-0.278195,-0.273183,-0.268170,-0.263158,-0.258145,-0.253133,-0.248120,-0.243108,-0.238095,-0.233083,-0.228070,-0.223058,-0.218045,-0.213033,-0.208020,-0.203008,-0.197995,-0.192982,-0.187970,-0.182957,-0.177945,-0.172932,-0.167920,-0.162907,-0.157895,-0.152882,-0.147870,-0.142857,-0.137845,-0.132832,-0.127820,-0.122807,-0.117794,-0.112782,-0.107769,-0.102757,-0.097744,-0.092732,-0.087719,-0.082707,-0.077694,-0.072682,-0.067669,-0.062657,-0.057644,-0.052632,-0.047619,-0.042607,-0.037594,-0.032581,-0.027569,-0.022556,-0.017544,-0.012531,-0.007519,-0.002506,0.002506,0.007519,0.012531,0.017544,0.022556,0.027569,0.032581,0.037594,0.042607,0.047619,0.052632,0.057644,0.062657,0.067669,0.072682,0.077694,0.082707,0.087719,0.092732,0.097744,0.102757,0.107769,0.112782,0.117794,0.122807,0.127820,0.132832,0.137845,0.142857,0.147870,0.152882,0.157895,0.162907,0.167920,0.172932,0.177945,0.182957,0.187970,0.192982,0.197995,0.203008,0.208020,0.213033,0.218045,0.223058,0.228070,0.233083,0.238095,0.243108,0.248120,0.253133,0.258145,0.263158,0.268170,0.273183,0.278195,0.283208,0.288221,0.293233,0.298246,0.303258,0.308271,0.313283,0.318296,0.323308,0.328321,0.333333,0.338346,0.343358,0.348371,0.353383,0.358396,0.363409,0.368421,0.373434,0.378446,0.383459,0.388471,0.393484,0.398496,0.403509,0.408521,0.413534,0.418546,0.423559,0.428571,0.433584,0.438596,0.443609,0.448622,0.453634,0.458647,0.463659,0.468672,0.473684,0.478697,0.483709,0.488722,0.493734,0.498747,0.503759,0.508772,0.513784,0.518797,0.523810,0.528822,0.533835,0.538847,0.543860,0.548872,0.553885,0.558897,0.563910,0.568922,0.573935,0.578947,0.583960,0.588972,0.593985,0.598997,0.604010,0.609023,0.614035,0.619048,0.624060,0.629073,0.634085,0.639098,0.644110,0.649123,0.654135,0.659148,0.664160,0.669173,0.674185,0.679198,0.684211,0.689223,0.694236,0.699248,0.704261,0.709273,0.714286,0.719298,0.724311,0.729323,0.734336,0.739348,0.744361,0.749373,0.754386,0.759398,0.764411,0.769424,0.774436,0.779449,0.784461,0.789474,0.794486,0.799499,0.804511,0.809524,0.814536,0.819549,0.824561,0.829574,0.834586,0.839599,0.844612,0.849624,0.854637,0.859649,0.864662,0.869674,0.874687,0.879699,0.884712,0.889724,0.894737,0.899749,0.904762,0.909774,0.914787,0.919799,0.924812,0.929825,0.934837,0.939850,0.944862,0.949875,0.954887,0.959900,0.964912,0.969925,0.974937,0.979950,0.984962,0.989975,0.994987,1.000000];
    const layout = {
      paper_bgcolor: "#0f141b",
      plot_bgcolor: "#0f141b",
      font: { color: "#e6e6e6" },
      xaxis: {
        title: "log-moneyness k",
        gridcolor: "#2b3340",
        zerolinecolor: "#2b3340"
      },
      yaxis: {
        title: "w(k)",
        gridcolor: "#2b3340",
        zerolinecolor: "#2b3340",
        range: [-0.2, 2]
      },
      margin: { l: 50, r: 20, t: 20, b: 45 }
    };

    function sviCurve(a, b, rho, m, sigma) {
      const y = new Array(k.length);
      for (let i = 0; i < k.length; i++) {
        const km = k[i] - m;
        const p2 = Math.sqrt(km * km + sigma * sigma);
        const p1 = rho * km;
        y[i] = a + b * (p1 + p2);
      }
      return y;
    }

    function update() {
      const a = parseFloat(document.getElementById("a").value);
      const b = parseFloat(document.getElementById("b").value);
      const rho = parseFloat(document.getElementById("rho").value);
      const m = parseFloat(document.getElementById("m").value);
      const sigma = parseFloat(document.getElementById("sigma").value);

      document.getElementById("a_val").textContent = a.toFixed(2);
      document.getElementById("b_val").textContent = b.toFixed(2);
      document.getElementById("rho_val").textContent = rho.toFixed(2);
      document.getElementById("m_val").textContent = m.toFixed(2);
      document.getElementById("sigma_val").textContent = sigma.toFixed(2);

      const y = sviCurve(a, b, rho, m, sigma);
      const trace = {
        x: k,
        y: y,
        mode: "lines",
        line: { color: "#00d0ff", width: 2 }
      };
      Plotly.react("plot", [trace], layout, { responsive: true });
    }

    ["a", "b", "rho", "m", "sigma"].forEach((id) => {
      document.getElementById(id).addEventListener("input", update);
    });

    update();
  </script>
</body>
</html>
